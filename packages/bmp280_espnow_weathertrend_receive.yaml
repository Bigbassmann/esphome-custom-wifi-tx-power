espnow:
  on_receive:
    then:
      - lambda: |-
          std::string sender_str = format_mac_address_pretty(info.src_addr);
          std::string received_str(reinterpret_cast<const char *>(data), size);
          id(received_weather_global) = received_str;
          ESP_LOGI("espnow", "Received: %s from %s", received_str.c_str(), sender_str.c_str());
          // Optional: Force display update if you have a display component
          id(display1).update();  // # Assuming your display ID is 'display1'; adjust as needed
globals:
  - id: received_weather_global
    type: std::string
    restore_value: yes # Optional: Persist across reboots
    initial_value: '"Calibrating..."' # Matches sender's initial state (uncommented for default value)

text_sensor:
  - platform: template
    name: "AQ Weather Trend Rec'd"
    id: weather_trend_display # Use this ID to replace the local weather_trend
    internal: true
    lambda: 'return id(received_weather_global);'
    update_interval: 30s # Poll the global periodically; adjust to match sender